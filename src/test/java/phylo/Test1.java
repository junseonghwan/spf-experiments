package phylo;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import phylo.models.JukesCantorModel;

public class Test1 {

	public static void main(String[] args) 
	{
		  String s0 = "CGATCATAAGTTCCCTTTGATCACGACCACCTTGAGTCTCACATACCGTAACTCTACTCATCCTAACAATCAACTGAGATGAGCTTAAGATAGTGGGTCTGTGCTGGCCTCGCCAGCTACTCCAGCTCTTATAGGCTTGACCTAGGATCCCAGCGGGATATGTTCCACACCGGGAGAGCATAATCTTCCGAGGTTTGCGCGTTATTAATCCAGACAGTCGCTCATGAAGCTATACCTGCACACTGCCACGCGGGACTTAAGCCGAGTGCTCAGAAAATAAGGCTCTGCATAGGTGGATTTAGATTGGAACTCGTTGAATGCCCCCGGGCATAGGCTGCGCTTGTAAAAAAAACCTCGGTGGGTGGTCAGCAGCGCCAATCGGCCCTATGAGGACCTGCGCTACGCGCTCCTTGTGGGCTGCACCCGTAGGGCCTACCGGTTTCGTCACAAAAATCCCTGCTAGACTTTTGGTCAAAGATGTCCGCTGCCGACTTCAGCCCACATCGATGGGTGCCTTTCGAGTAACTAGCCTCTTTCGGCTCATACGATCTCTTATGTTTGAACACAAACCCGCGGCGTGAACTCTAGACTGTACTAGGTTTAGACGGTGCGTGGAATACGCGACGGGATGTAGTCCCGTAACGCGGAGGGCTTCTCCTTGAGACTAGAGGCTCCCTTCGAGAATGTATGTGGCATTTGGTTTCCCGTACTTGAGATTAAAAAGGTAATCTATATAAAGCTTTCTTTAGTACGAGGGAGACAGTCGTTACTCCACCGAACGGTAGGCCCACGACCAGAGTATATAAGGGCATACAACCACCTTGAGTGTTCACGTGAACCACCGGATAGGAGATCTAATGGGCCTATCAACTGGTGGGTAAACGGTTACACAGCCTGTAAAGGGCCAGCCCAGTTGCCTTCGGGCGGAGCCACAAGCTTACCTCTGGAAGATACCTGGTCAGAGACTTCGTCTGTGACATTTTGCTCAACTGGATCCCCA";
		  String s1 = "CCGGCACCAGCGATACCCTCTACTATCCGGTTGAAATGCCAGACCCAGTAAGGGAGTATCCAACGCTGCTGTCGTCAGGCCAGAAAAGCGCAGCCTGTCTTTGCAAGTTTCTTCACGCGGCTTCCCGGCCCCGATTTAGTGTGACTATATCATACCTCGGATGGCCGAGCAGCGTACGTTCTTGCCCGTATTTCGAGCATACAAGTTTCTATATGCCCGGGGCAAGCCTCTTGTGATGTGCCGGTGGATTAGTCCCTCAACAGACACGTCTCACCAGTGGTGTACAGACGTAGCCCTTCATTATTTGCCCAGCAATTAAGGGGGACATGTCGAGCCTACCAGTAGAATGAGCACTCGCTTTTCTAGGCACTCTACTTAATTGAGGTGGATAAGGATACAGTGTGCCAAGGCAATTTGATGCTCCCTCTGGTGTGACGAACATCTTCATTTGCCGTACAGCTTCGCTCTCGATACACTAATTGGCAGTATGCAGGTCCTATATAGCGTGCACCAGAGTTGATTCCCTGGATGATAGATCGTGCGTTCCTTCCAATACACCTAGGACGGCGATAAAGGGTGAGTTAGGGAAGATGCAGATCGTGCCCCAAGGAGGAGCGGCTCGCCCAGCGGACTTAATTGTCTCGTCAGGCTTTATGTCGGTGTATTCGGGACGTTAATGGCTCAATCCACGTATTTTGCGTATGCGTTGAGCTTTGAGTAACGCGCTGCTAAGTGATAATACCTGTACTTCCGCGCCTCAACACTACAGCAGCTGTAGCGCTGGTACCGATCTCCCTGGTGGGCTGAGCAGTTGCTCACTGCTTATCGGACGACGGTAGCCACTGCAAGACTCATTGAATTGGGGTGTCCCTCTGAGTAGCTTTGATAGTAAGGGGTTCAAGGCTAAATTTTGGACAGTCTTCGACTACGCACGGCAACGGGCTCCTAAGTCCGTTCCGTCCATACCAATTATTGACTGTTTAAGGATTAGAAGATTTGG";
		  String s2 = "CCGCCACCAGTGACACCTTCTACTATCCGGTTGTAATGCCAGACCCAGTAAGGGAGTAACTAACGCTGCTATCGTCAGGTCAGAAAAGCACAGGCTGTCTTCGCAAAGTTCTTCACACGGCTTCCCGGCCCCGATTTAGTGTGACTATATCATACCTTGGATGACCGAGAAGCGTGCATTCTTGCCCGTATTCCGTGAATACAGACCTCTAGGTGCTCGGAGGAAGCCTCTTGTAATGTGCCGGTGGATAAGTCCCTCAATAGACACGTATCACCAGCGGTGTCCAGACGTTACCCTCAATTATTTGCCCAGCAGTTAAGTAGGACATGTCGAGCCTACTAGCAGAATGAGCACTCGTTTTTTTAGGCACTCTAACTAATCGACGAGGATAGGGACACAGTTCGCCAAGACAATTTGATGCTCCTTCTGGTGTCACAGACATCTTCATTTGTCGTACAGCTTCGCACTCGATACACTGATTGGTATTATGCGGATCCTAGACAGCATGCACCGGAGTTGATTCCTAGGATGCTAGATCGTGTGTTTCTTACAATGCACACGGGACGGCGATAAAGGGAGAGTTAGGAAAGATGCGGATCGTGCCCCTAGAAGGAGCGGCTCGCCCAGCGTACTCAATTGTCTCGTTAGGCTTTATGTCGGTGTTCTCGGGACGTTAAAGGCTTAATCCACGTGCTGCCCATATACGTTGACCTTTGAGTAACGCGCTGCTACGTGATAATAACTGCATTTCCGTGCCTCAACATTGCGGCAGGTGTAGCGCTGGTACCCATCCCCCTGGTGGGCGAAGCAGTTGCTCACTGCTTATCGGACGAAGGAAGTCACTGCGAGACTCGTTGGGTTGGGGTGTCCCTCTGAGTAGCTTTGATAGTAAGGGATGCAAGGCTAGATTTTGGACAGTGATCGGCTACGCGCGGCAGCGGGCTCCTAAGTCTGTTTCGTCCATACCAATGATTGACCGTTTAAGGGTTAGAAGATTTGG";
		  String s3 = "CGATCATAAGTTCCCATTGATCACGATCACCTTGAGTCTCACGTACCGTACCTCTACTCATCCTAACAATCAACTGAGATGAGCCTAAGATAGTGGGGCTGCGCTGGCCTTGCCAGCCACTCCAGCTCTTATAGGCTTGACCTAGGCTCCCAGCGGGATATGTTCCACACCGGGAGAGCTTAATCTTCCGAGGTTTGCGCGCTATTAATCCAGACAGTCGCTCATGTTGCTATACCTGCACGCTACCACGCGGGACTTAAGCCGAGTGCTCAAAAAATAAGACTCTGCCTAGGTGGATCTAGATTGGAACTCGTTGACTGCCCCCGGGCAAAGGCTGCGCTTGTAAAAAAGAGCTCGGCGGGTGGTCAGCAGCGCCAATCGGCCCTATGAGGACCTTCGCTACGCGCTCTTTGTGGGCTGCTCCCGTAGGGCCTGCCGGTTTCGTCACAAAAATCCTTGCTAAACTTTTGGTCGAAGATGTCCGCTGTCGACTTCAACCCACCTGGATGGGTGCCTTTCGAGTAACTAGCCTCTTTCGGCTCATACGATCTCTGGTGTATGAACACAAACCCGCGGGGTGAACTCTAGAGTGTACTAGATTTAGACGGTGCGTGGAATACGCGACGGGAAGAAGTCCCGTAACGCGGCGGGCTTCTTCGTGAGACTAGAGGCTCCGTTCGACAATGTATGTACTATTTGGTTTCCCGTACTTAAGATTAAAAAGGTAGTCTGTATAAAGCTTTCTTTAATACGAGGGAGACATTCGTTACTCCACCGAACGGTAGGCCCACGACCAGAGTATATACGGCCATACAACCACCTTGAGTGTTTACGTGAACCACCTGACAGCAGATCTAATGGGCCTATCATCTGGTTGGTAAACGGTTACACGGCCTGCAAAGGGCCAGCCCAGTTGCTTTCGGGCGGAACCACAAGCTTACCTCTGGAAGATACCTAGTCGGAGACTTCGTCTGAGACATTATGCTCAACTGGATCCCCA";
		/*
		  String s0 = "GC";
		  String s1 = "CA";
		  String s2 = "CC";
		  String s3 = "GG";
		  */
		  String [] s = new String[4];
		  s[0] = s0; s[1] = s1; s[2] = s2; s[3] = s3;
		  
		  // test the loglikelihood computation
		  List<Taxon> taxa = new ArrayList<Taxon>();
		  for (int i = 0; i < 4; i++) {
			  Taxon taxon = new Taxon("T" + (i+1));
			  taxon.setSequence(s[i]);
			  taxa.add(taxon);
		  }
		  double mutationRate = 1.0;
		  JukesCantorModel jc = new JukesCantorModel(mutationRate);
		  PhyloOptions.calc = new FelsensteinPruningSystBiol2012(jc);
		
		  PartialCoalescentState currState = PartialCoalescentState.getInitial(taxa);
		  //PriorPriorProblemSpecification kernel = new PriorPriorProblemSpecification(taxa);
		  Random rand = new Random(1172);
		  double prevLogW = 0;
		  for (int i = 0; i < 3; i++) {
			  PartialCoalescentState ret = currState.coalesce(rand, false);
			  //System.out.println(ret);
			  System.out.println("particle weight: " + ret.logRatio());
			  currState = ret;
			  prevLogW = ret.logRatio();
		  }

	}

}
